# 各メニューの使い方

家計簿アプリの各メニューでできることと、基本的な操作手順をまとめています。メニュー一覧は [menus.md](menus.md) を参照してください。

---

## 1. ダッシュボード

### できること

- 指定した年月の収支サマリ（収入・支出・収支・繰越残高）を確認する
- 分類別支出トップ10を確認する
- 予算と実支出の比較（予算 vs 実支出）を確認する

### 使い方

1. 画面上部の **「ダッシュボード」** または **「家計簿アプリ」** をクリックして画面を開く
2. 表示されているカードで **当月収入・当月支出・当月収支・繰越残高** を確認する
3. **分類別支出トップ10** の表で、どの分類にいくら使ったかを確認する
4. **予算 vs 実支出** の表で、予算に対して実績がどうなっているかを確認する

### 補足

- 表示する年月は URL のクエリで変更できます（例: `/dashboard?year=2024&month=3`）。画面上に年月の入力欄はありません
- **「年間収支表」** ボタンから、1年分の月別収支表を表示する画面に移動できます
- ローカル環境では、テストデータ登録年月の案内が表示される場合があります

---

## 2. 年間収支表

### できること

- 年を指定して、その年の1月〜12月の月別の収入・支出・差額・繰越を一覧で確認する
- 年間の収入合計・支出合計・差額合計を表の下部で確認する

### 使い方

1. 画面上部の **「年間収支」** メニューをクリックするか、ダッシュボードの **「年間収支表」** をクリックする
2. **年** を入力し（例: 2024）、**「表示」** をクリックする
3. 表で各月の **収入・支出・差額（収入−支出）・繰越** を確認する
4. 表の最下行で、その年の **収入合計・支出合計・差額合計** を確認する
5. **「ダッシュボードに戻る」** でダッシュボードに戻る

### 補足

- 繰越は「その月の末日時点での残高」です。前月までの収支を反映した残高に、当月の差額を足した値です
- 差額がプラスは緑、マイナスは赤で表示されます

---

## 3. 取引明細

### できること

- 収入・支出の取引を一覧で見る
- 年月・種別（収入／支出／すべて）で絞り込む
- 取引を新規登録・編集・削除する

### 一覧の見方・絞り込み

1. **「取引明細」** メニューをクリックする
2. 画面上部の **年**・**月** を入力し、**種別**（すべて／収入／支出）を選んで **「フィルタ」** を押す
3. 一覧には **日付・種別・支払手段・分類・項目・金額** が表示される。各行の **「編集」**・**「削除」** で操作できる

### 新規登録の手順

1. 一覧画面で **「新規登録」** をクリックする
2. 次の項目を入力する：
   - **日付**（必須）
   - **種別**：支出 or 収入（必須）
   - **支払手段**：マスタで登録したものから選択（任意）
   - **分類**：マスタで登録したものから選択（任意）
   - **項目名**（必須）
   - **金額**（必須）
   - **定期支出**：チェックを付けると定期支出として扱う（任意）
   - **メモ**・**タグ（カンマ区切り）**（任意）
3. **「登録」** をクリックする

### 編集・削除

- **編集**：一覧の **「編集」** から同じ項目を変更し、保存する
- **削除**：一覧の **「削除」** を押し、確認ダイアログで **OK** を選ぶ

---

## 4. 予算

### できること

- 月別・分類別の予算を設定する
- 一覧で予算額・実績額・残り・達成率（または超過）を確認する
- 予算の新規登録・編集・削除をする

### 一覧の見方・絞り込み

1. **「予算」** メニューをクリックする
2. **年**・**月** を入力して **「フィルタ」** を押すと、その年月の予算一覧が表示される
3. 各予算の **予算額・実績額・残り・達成率** を確認する。超過時は「超過」と表示される

### 新規登録の手順

1. 一覧画面で **「新規登録」** をクリックする（表示中の年月が初期値になる）
2. **年**・**月**・**分類**・**予算額** を入力する
3. **「登録」** をクリックする  
   ※ 同じ年月・同じ分類の予算は重複登録できません（エラーになります）

### 編集・削除

- **編集**：一覧の **「編集」** から予算額などを変更する
- **削除**：一覧の **「削除」** を押し、確認で **OK** を選ぶ

---

## 5. 定期支出

### できること

- 毎月同じ日に発生する支出（家賃・通信費など）を「ルール」として登録する
- 登録したルールから **「今月分を生成」** で取引明細を一括作成する
- ルールの新規登録・編集・削除、有効/無効の切り替えをする

### 一覧の見方

1. **「定期支出」** メニューをクリックする
2. 一覧には **支払手段・引落日・項目名・金額・分類・状態（有効/無効）** が表示される

### 新規登録の手順

1. **「新規登録」** をクリックする
2. 次の項目を入力する：
   - **支払手段**（必須）
   - **引落日**：1〜31日（必須）
   - **項目名**（必須）
   - **金額**（必須）
   - **分類**（任意）
   - **有効**：チェックで有効、外すと無効（無効のルールは「今月分を生成」の対象外）
3. **「登録」** をクリックする

### 今月分を生成

1. 一覧画面で **「今月分を生成」** をクリックする
2. 有効な定期支出ルールに基づき、今月分の取引が **取引明細** に自動で追加される
3. 既に同じ月で生成済みの取引がある場合は重複しないよう注意して利用する

### 編集・削除

- **編集**：一覧の **「編集」** から内容を変更する
- **削除**：一覧の **「削除」** を押し、確認で **OK** を選ぶ

---

## 6. 分割払い

### できること

- 分割払いのプラン（案件名・毎月額・回数など）を登録する
- 毎月の支払いがあったときに **「支払記録」** で残回数を減らす
- プランの新規登録・編集・削除をする

### 一覧の見方

1. **「分割払い」** メニューをクリックする
2. 一覧には **案件名・開始日・支払日・毎月額・残回数・状態（有効/完了）** が表示される

### 新規登録の手順

1. **「新規登録」** をクリックする
2. 次の項目を入力する：
   - **案件名**（必須）
   - **開始日**（必須）
   - **支払日**：毎月の支払い日（1〜31日）（必須）
   - **毎月額**（必須）
   - **総支払回数**（必須）
   - **支払手段**・**分類**（任意）
3. **「登録」** をクリックする

### 支払いを記録する

1. 一覧で該当プランの **「支払記録」** をクリックする
2. 残回数が 1 回減り、予定表などにも反映される（残回数が 0 になると「支払記録」は表示されず、状態が「完了」になる）

### 編集・削除

- **編集**：一覧の **「編集」** から内容を変更する
- **削除**：一覧の **「削除」** を押し、確認で **OK** を選ぶ

---

## 7. 予定表（キャッシュフロー）

### できること

- 指定した期間の収支予定を日付順で確認する
- 日付ごとの収入・支出・残高の流れを把握する
- **「定期支出から同期」** で、定期支出ルールを予定表に反映する
- 手動で予定（収入・支出）を追加・編集・削除する

### 一覧の見方・絞り込み

1. **「予定表」** メニューをクリックする
2. **開始日**・**終了日** を指定して **「フィルタ」** を押す
3. 表には **日付・項目名・収入・支出・残高** が表示される。編集できる行には **「編集」** が表示される

### 定期支出から同期

1. 期間を指定した状態で **「定期支出から同期」** をクリックする
2. 有効な定期支出ルールが、指定期間内の日付で予定表に反映される（既存の予定と重複する場合は仕様に従って更新される）

### 手動で予定を登録する

1. **「新規登録」** をクリックする
2. **日付**・**項目名** を入力する
3. **収入額** または **支出額** のどちらか（または両方）を入力する
4. **メモ**（任意）を入力し、**「登録」** をクリックする

### 編集

- 一覧で **「編集」** が表示されている行だけ、編集画面で内容を変更できる（同期で生成された行は編集できない場合がある）

---

## 8. マスタ

### 8.1 支払手段

#### できること

- 現金・口座・カードなど「支払手段」を登録し、取引・定期支出・分割払いで選択できるようにする
- 一覧で確認し、編集・削除する

#### 新規登録の手順

1. **「マスタ」** → **「支払手段」** をクリックする
2. **「新規登録」** をクリックする
3. **名称**（必須）・**種別**（カード／現金／銀行／その他）（必須）・**有効**（チェックで有効）を入力する
4. **「登録」** をクリックする

#### 編集・削除

- 一覧の **「編集」** で名称・種別・有効を変更する
- **「削除」** で削除する（この支払手段を参照している取引などがある場合は注意）

---

### 8.2 分類

#### できること

- 収入・支出の「分類」を登録し、取引・予算などで選択できるようにする
- 一覧で確認し、編集・削除する

#### 新規登録の手順

1. **「マスタ」** → **「分類」** をクリックする
2. **「新規登録」** をクリックする
3. **名称**（必須）・**種別**（支出／収入）（必須）・**色（HEXコード）**（任意、デフォルトは青）を入力する
4. **「登録」** をクリックする

#### 編集・削除

- 一覧の **「編集」** で名称・種別・色を変更する
- **「削除」** で削除する（この分類を参照している取引・予算がある場合は注意）

---

## 9. インポート/エクスポート

### できること

- CSV ファイルから取引を一括インポートする
- 指定した年月の取引を CSV でエクスポートする

### CSV インポートの手順

1. **「インポート/エクスポート」** メニューをクリックする
2. **CSVインポート** の欄で次を指定する：
   - **CSVファイル**：取引データの CSV（.csv または .txt）を選択
   - **年**・**月**：インポートする取引の年月（必須）
3. **「インポート」** をクリックする

#### CSV 形式

- 1行目はヘッダー（読み飛ばされます）
- 2行目以降：**日付, 支払手段, 分類, 項目, 金額, 定期フラグ** の順（支払手段・分類は名称で、マスタに存在するものを指定）

### CSV エクスポートの手順

1. **「インポート/エクスポート」** 画面の **CSVエクスポート** の欄で **年**・**月** を指定する
2. **「エクスポート」** をクリックする
3. 指定年月の取引が CSV としてダウンロードされる

---

## 10. ユーザーメニュー

画面上部右端の **自分の名前** をクリックするとドロップダウンが開きます。

### 10.1 プロフィール

- **できること**：名前・メールアドレスの変更、パスワード変更、アカウント削除、ログインログへのリンク
- **使い方**：**「プロフィール」** をクリックし、各フォームで内容を変更して保存する。アカウント削除は専用フォームでパスワード入力後に実行する

### 10.2 ログインログ

- **できること**：自分のアカウントへのログイン試行（成功・失敗）の履歴を一覧で確認する
- **使い方**：**「ログインログ」** をクリックする。**日時・ステータス・IPアドレス・User-Agent** が表示される。不審なアクセスがないか確認する

### 10.3 ログアウト

- **できること**：ログイン状態を終了する
- **使い方**：ドロップダウン内の **「ログアウト」** をクリックする

---

## 参照

- メニュー一覧・ルート・機能の有無: [menus.md](menus.md)
- ナビ定義: `resources/views/layouts/navigation.blade.php`
